<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Go é”™è¯¯å¤„ç† | Go è¯­è¨€ç¬”è®°</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?ce26c35c5c5403057ebddcb99965920a";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
    <meta name="description" content=" ">
    
    <link rel="preload" href="/assets/css/0.styles.77dfaa16.css" as="style"><link rel="preload" href="/assets/js/app.d9c230db.js" as="script"><link rel="preload" href="/assets/js/2.644a76e8.js" as="script"><link rel="preload" href="/assets/js/9.859ef89a.js" as="script"><link rel="prefetch" href="/assets/js/10.8da66157.js"><link rel="prefetch" href="/assets/js/11.bd814098.js"><link rel="prefetch" href="/assets/js/12.414b18af.js"><link rel="prefetch" href="/assets/js/13.760618b2.js"><link rel="prefetch" href="/assets/js/14.8a073efc.js"><link rel="prefetch" href="/assets/js/15.f2fabb86.js"><link rel="prefetch" href="/assets/js/3.6529368c.js"><link rel="prefetch" href="/assets/js/4.e05c873c.js"><link rel="prefetch" href="/assets/js/5.76fc70b2.js"><link rel="prefetch" href="/assets/js/6.498ab014.js"><link rel="prefetch" href="/assets/js/7.11760ee6.js"><link rel="prefetch" href="/assets/js/8.94349a7b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.77dfaa16.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Go è¯­è¨€ç¬”è®°</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">å‰è¨€</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>åŸºç¡€</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>è¿›é˜¶</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/advance/error.html" aria-current="page" class="active sidebar-link">Go é”™è¯¯å¤„ç†</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/advance/error.html#æ„é€ -error" class="sidebar-link">æ„é€  error</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/advance/error.html#ğŸ› ï¸errors-new" class="sidebar-link">ğŸ› ï¸errors.New()</a></li><li class="sidebar-sub-header"><a href="/advance/error.html#ğŸ› ï¸fmt-errorf" class="sidebar-link">ğŸ› ï¸fmt.Errorf()</a></li></ul></li><li class="sidebar-sub-header"><a href="/advance/error.html#panic-ä¸-recover" class="sidebar-link">panic() ä¸ recover()</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/advance/error.html#panic" class="sidebar-link">panic()</a></li><li class="sidebar-sub-header"><a href="/advance/error.html#recover" class="sidebar-link">recover()</a></li></ul></li></ul></li><li><a href="/advance/concurrent.html" class="sidebar-link">å¹¶å‘</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å®æˆ˜</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="go-é”™è¯¯å¤„ç†"><a href="#go-é”™è¯¯å¤„ç†" class="header-anchor">#</a> Go é”™è¯¯å¤„ç†</h1> <h2 id="æ„é€ -error"><a href="#æ„é€ -error" class="header-anchor">#</a> æ„é€  error</h2> <p>åœ¨ go è¯­è¨€ä¸­ï¼Œæœ‰ä¸€ä¸ªé¢„å®šä¹‰çš„æ¥å£ï¼š<code>error</code>ï¼Œè¯¥æ¥å£è‡ªå¸¦ä¸€ä¸ª <code>Error()</code> æ–¹æ³•ï¼Œè°ƒç”¨è¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> <span class="token builtin">error</span> <span class="token keyword">interface</span> <span class="token punctuation">{</span>
  <span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è°ƒç”¨è¯¥æ–¹æ³•ï¼Œä¼šè¿”å›å½“å‰é”™è¯¯çš„å…·ä½“ç»“æœã€‚ä¸€èˆ¬æœ‰ä¸‹é¢å‡ ç§æ–¹å¼ç”Ÿæˆ errorã€‚</p> <ul><li><code>errors.New()</code></li> <li><code>fmt.Errorf()</code></li></ul> <h3 id="ğŸ› ï¸errors-new"><a href="#ğŸ› ï¸errors-new" class="header-anchor">#</a> ğŸ› ï¸errors.New()</h3> <p>è°ƒç”¨ <code>errors.New()</code> ä¼šè¿”å›ä¸€ä¸ª error ç±»å‹çš„ç»“æ„ä½“ï¼Œè¯¥ç»“æ„ä½“å†…éƒ¨ä¼šå®ç°ä¸€ä¸ª <code>Error()</code> æ–¹æ³•ï¼Œ è°ƒç”¨è¯¥æ–¹æ³•è¿”å›çš„ç»“æœä¸ºè°ƒç”¨ <code>errors.New()</code> æ–¹æ³•æ—¶ä¼ å…¥çš„å†…å®¹ã€‚</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;errors&quot;</span>
	<span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">divide</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">error</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
    <span class="token comment">// è¢«é™¤æ•°ä¸º0ï¼Œåˆ™æ„é€ ä¸€ä¸ª error ç»“æ„ä½“</span>
		<span class="token keyword">return</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;è¢«é™¤æ•°ä¸èƒ½ä¸º0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">var</span> result <span class="token operator">=</span> a <span class="token operator">/</span> b
	<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> result
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> err <span class="token builtin">error</span> <span class="token comment">// error ç±»å‹æ•°æ®çš„åˆå§‹å€¼ä¸º nilï¼Œç±»ä¼¼äº js ä¸­çš„ null</span>
	<span class="token keyword">var</span> result <span class="token builtin">int</span>

	err<span class="token punctuation">,</span> result <span class="token operator">=</span> <span class="token function">divide</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>

  <span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¦‚æœ err ä¸º nilï¼Œè¯´æ˜è¿è¡Œæ­£å¸¸</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;è®¡ç®—ç»“æœ&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¦‚æœ err ä¸ä¸º nilï¼Œè¯´æ˜è¿è¡Œå‡ºé”™</span>
    <span class="token comment">// è°ƒç”¨ error ç»“æ„ä½“çš„ Error æ–¹æ³•ï¼Œè¾“å‡ºé”™è¯¯åŸå› </span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;è®¡ç®—å‡ºé”™&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸Šé¢çš„ä»£ç ä¸­ï¼Œç”±äºè°ƒç”¨ <code>divide</code> é™¤æ³•æ–¹æ³•æ—¶ï¼Œç”±äºä¼ å…¥çš„è¢«é™¤æ•°ä¸º 0ã€‚ç»è¿‡åˆ¤æ–­ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªç”± <code>errors.New</code> æ„é€ çš„ <code>error</code> ç±»å‹çš„ç»“æ„ä½“ã€‚</p> <p>æˆ‘ä»¬å°†è°ƒç”¨ <code>error.Error()</code> æ–¹æ³•è¿”å›çš„ç»“æœè¾“å‡ºåˆ°æ§åˆ¶å°ï¼Œå¯ä»¥å‘ç°å…¶è¿”å›çš„ç»“æœï¼Œå°±æ˜¯ä¼ å…¥ <code>New</code> æ–¹æ³•çš„å€¼ã€‚</p> <p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p> <p><img src="https://file.shenfq.com/pic/20210427164350.png" alt=""></p> <h3 id="ğŸ› ï¸fmt-errorf"><a href="#ğŸ› ï¸fmt-errorf" class="header-anchor">#</a> ğŸ› ï¸fmt.Errorf()</h3> <p>é€šè¿‡ <code>fmt.Errorf()</code> æ–¹æ³•æ„é€ çš„ error ç»“æ„ä½“ï¼Œä¸è°ƒç”¨  <code>errors.New()</code> æ–¹æ³•çš„ç»“æœç±»ä¼¼ã€‚ä¸åŒçš„æ˜¯ï¼Œ<code>fmt.Errorf()</code> æ–¹æ³•ä¼šè¿›è¡Œä¸€æ¬¡æ•°æ®çš„æ ¼å¼åŒ–ã€‚</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">divide</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">error</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
    <span class="token comment">// å°†å‚æ•°è¿›è¡Œä¸€æ¬¡æ ¼å¼åŒ–ï¼Œæ ¼å¼åŒ–åçš„å­—ç¬¦ä¸²æ”¾å…¥ error ä¸­</span>
		<span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;æ•°æ® %d ä¸åˆæ³•&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">var</span> result <span class="token operator">=</span> a <span class="token operator">/</span> b
	<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> result
<span class="token punctuation">}</span>

err<span class="token punctuation">,</span> result <span class="token operator">:=</span> <span class="token function">divide</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;è®¡ç®—å‡ºé”™&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p> <p><img src="https://file.shenfq.com/pic/20210427165114.png" alt=""></p> <h2 id="panic-ä¸-recover"><a href="#panic-ä¸-recover" class="header-anchor">#</a> panic() ä¸ recover()</h2> <h3 id="panic"><a href="#panic" class="header-anchor">#</a> panic()</h3> <p><code>panic()</code> ç›¸å½“äºä¸»åŠ¨åœæ­¢ç¨‹åºè¿è¡Œï¼Œè°ƒç”¨æ—¶ <code>panic()</code> æ—¶ï¼Œéœ€è¦ä¼ å…¥ä¸­æ–­åŸå› ã€‚è°ƒç”¨åï¼Œä¼šåœ¨æ§åˆ¶å°è¾“å‡ºä¸­æ–­åŸå› ï¼Œä»¥åŠä¸­æ–­æ—¶çš„è°ƒç”¨å †æ ˆã€‚æˆ‘ä»¬å¯ä»¥æ”¹é€ ä¸€ä¸‹ä¹‹å‰çš„ä»£ç ï¼š</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">divide</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">error</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
    <span class="token comment">// å¦‚æœç¨‹åºå‡ºé”™ï¼Œç›´æ¥åœæ­¢è¿è¡Œ</span>
		<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">&quot;è¢«é™¤æ•°ä¸èƒ½ä¸º0&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">var</span> result <span class="token operator">=</span> a <span class="token operator">/</span> b
	<span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> result
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  err<span class="token punctuation">,</span> result <span class="token operator">:=</span> <span class="token function">divide</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;è®¡ç®—å‡ºé”™&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åœ¨è¿è¡Œåˆ° <code>panic()</code> å¤„ï¼Œç¨‹åºç›´æ¥ä¸­æ–­ï¼Œå¹¶åœ¨æ§åˆ¶å°æ‰“å°å‡ºäº†ä¸­æ–­åŸå› ã€‚</p> <p><img src="https://file.shenfq.com/pic/20210427174701.png" alt=""></p> <p><code>panic()</code> å¯ä»¥ç†è§£ä¸ºï¼Œjs ç¨‹åºä¸­çš„ <code>throw new Error()</code> çš„æ“ä½œã€‚é‚£ä¹ˆï¼Œåœ¨ go ä¸­æœ‰æ²¡æœ‰åŠæ³•ç»ˆæ­¢ <code>panic()</code> ï¼Œä¹Ÿå°±æ˜¯ç±»ä¼¼äº <code>try-catch</code> çš„æ“ä½œï¼Œè®©ç¨‹åºå›åˆ°æ­£å¸¸çš„è¿è¡Œé€»è¾‘ä¸­å‘¢ï¼Ÿ</p> <h3 id="recover"><a href="#recover" class="header-anchor">#</a> recover()</h3> <p>åœ¨ä»‹ç» <code>recover()</code> æ–¹æ³•ä¹‹å‰ï¼Œè¿˜éœ€è¦ä»‹ç»ä¸€ä¸ª go è¯­è¨€ä¸­çš„å¦ä¸€ä¸ªå…³é”®å­—ï¼š<code>defer</code>ã€‚</p> <p><code>defer</code> åçš„è¯­å¥ä¼šåœ¨å‡½æ•°è¿›è¡Œ return æ“ä½œä¹‹å‰è°ƒç”¨ï¼Œå¸¸ç”¨äº<code>èµ„æºé‡Šæ”¾</code>ã€<code>é”™è¯¯æ•è·</code>ã€<code>æ—¥å¿—è¾“å‡º</code>ã€‚</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">getData</span><span class="token punctuation">(</span>table<span class="token punctuation">,</span> sql<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">defer</span> ä¸­æ–­è¿æ¥<span class="token punctuation">(</span><span class="token punctuation">)</span>
  db <span class="token operator">:=</span> å»ºç«‹è¿æ¥<span class="token punctuation">(</span>table<span class="token punctuation">)</span>
  data <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token keyword">select</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
  <span class="token keyword">return</span> data
<span class="token punctuation">}</span>
</code></pre></div><p><code>defer</code> åçš„è¯­å¥ä¼šè¢«å­˜å‚¨åœ¨ä¸€ä¸ªç±»ä¼¼äºæ ˆçš„æ•°æ®ç»“æ„å†…ï¼Œåœ¨å‡½æ•°ç»“æŸçš„æ—¶å€™ï¼Œè¢«å®šä¹‰çš„è¯­å¥æŒ‰é¡ºåºå‡ºæ ˆï¼Œè¶Šåé¢å®šä¹‰çš„è¯­å¥è¶Šå…ˆè¢«è°ƒç”¨ã€‚</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">divide</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
  <span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;é™¤æ•°ä¸º&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
  <span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;è¢«é™¤æ•°ä¸º&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>

  result <span class="token operator">:=</span> a <span class="token operator">/</span> b
  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;è®¡ç®—ç»“æœä¸º&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
	<span class="token keyword">return</span> result
<span class="token punctuation">}</span>

<span class="token function">divide</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬åœ¨å‡½æ•°å¼€å§‹è¿è¡Œçš„æ—¶å€™ï¼Œå…ˆé€šè¿‡ <code>defer</code> å®šä¹‰äº†ä¸¤ä¸ªè¾“å‡ºè¯­å¥ï¼Œå…ˆè¾“å‡º<code>é™¤æ•°</code>ï¼Œåè¾“å‡º<code>è¢«é™¤æ•°</code>ã€‚</p> <p><img src="https://file.shenfq.com/pic/20210428114124.png" alt=""></p> <p>å®é™…çš„è¿è¡Œç»“æœæ˜¯ï¼š</p> <ul><li>å…ˆè¾“å‡ºè®¡ç®—ç»“æœï¼›</li> <li>ç„¶åè¾“å‡ºè¢«é™¤æ•°ï¼›</li> <li>æœ€åè¾“å‡ºé™¤æ•°ï¼›</li></ul> <p>è¿™å’Œå‰é¢æåˆ°çš„ï¼Œé€šè¿‡ <code>defer</code> å®šä¹‰çš„è¯­å¥ä¼šåœ¨å‡½æ•°ç»“æŸçš„æ—¶å€™ï¼ŒæŒ‰ç…§å‡ºæ ˆçš„æ–¹å¼è¿›è¡Œæ‰§è¡Œï¼Œå…ˆå®šä¹‰çš„åæ‰§è¡Œã€‚<code>defer</code> é™¤äº†ä¼šåœ¨å‡½æ•°ç»“æŸçš„æ—¶å€™æ‰§è¡Œï¼Œå‡ºç°å¼‚å¸¸çš„çš„æ—¶å€™ä¹Ÿä¼šå…ˆèµ° <code>defer</code> çš„é€»è¾‘ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨äº† <code>panic()</code> æ–¹æ³•åï¼Œç¨‹åºä¸­æ–­è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šå…ˆå°† <code>defer</code> å†…çš„è¯­å¥è¿è¡Œä¸€éã€‚</p> <p>è¿™é‡Œæˆ‘ä»¬é‡æ–°å®šä¹‰ä¹‹å‰çš„ <code>divide</code> å‡½æ•°ï¼Œåœ¨æ‰§è¡Œä¹‹å‰åŠ ä¸Šä¸€ä¸ª <code>defer</code> è¯­å¥ï¼Œ<code>defer</code> åé¢ä¸ºä¸€ä¸ªè‡ªæ‰§è¡Œå‡½æ•°ï¼Œè¯¥å‡½æ•°å†…ä¼šè°ƒç”¨ <code>recover()</code> æ–¹æ³•ã€‚</p> <p><img src="https://file.shenfq.com/pic/20210428120154.png" alt=""></p> <p><code>recover()</code> æ–¹æ³•è°ƒç”¨åï¼Œä¼šæ•è·åˆ°å½“å‰çš„ <code>panic()</code> æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå¹¶è¿›è¡Œè¿”å›ï¼Œå¦‚æœæ²¡æœ‰å¼‚å¸¸ï¼Œåˆ™è¿”å› <code>nil</code>ã€‚</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">divide</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
  <span class="token comment">// ä¸­æ–­ä¹‹å‰ï¼Œè°ƒç”¨ defer åå®šä¹‰çš„è¯­å¥</span>
	<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> err <span class="token operator">:=</span> <span class="token function">recover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;æ•è·é”™è¯¯&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
    <span class="token comment">// å‡½æ•°è¿è¡Œè¢«ä¸­æ–­</span>
		<span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">&quot;è¢«é™¤æ•°ä¸èƒ½ä¸º0&quot;</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token number">0</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> a <span class="token operator">/</span> b
<span class="token punctuation">}</span>

result <span class="token operator">:=</span> <span class="token function">divide</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;è®¡ç®—ç»“æœ&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
</code></pre></div><p>ä¸Šé¢çš„ä»£ç è¿è¡Œåï¼Œæˆ‘ä»¬å‘ç°ä¹‹å‰è°ƒç”¨ <code>panic()</code> ä¸­æ–­çš„ç¨‹åºè¢«æ¢å¤äº†ï¼Œè€Œä¸”åé¢çš„è®¡ç®—ç»“æœä¹Ÿæ­£å¸¸è¿›è¡Œè¾“å‡ºäº†ã€‚</p> <p><img src="https://file.shenfq.com/pic/20210428120544.png" alt=""></p> <p>è¿™å°±æœ‰ç‚¹ç±»ä¼¼äº <code>try-catch</code> çš„é€»è¾‘äº†ï¼Œåªæ˜¯ <code>recover</code> éœ€è¦æ”¾åœ¨ <code>defer</code> å…³é”®è¯åçš„è¯­å¥ä¸­ï¼Œæ›´åƒæ˜¯ <code>catch</code> å’Œ <code>finally</code> çš„ç»“åˆã€‚</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">æœ€åæ›´æ–°æ—¶é—´:</span> <span class="time">4/28/2021, 4:24:30 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/basic/struct.html" class="prev">
        ç»“æ„ä½“ä¸æ–¹æ³•
      </a></span> <span class="next"><a href="/advance/concurrent.html">
        å¹¶å‘
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d9c230db.js" defer></script><script src="/assets/js/2.644a76e8.js" defer></script><script src="/assets/js/9.859ef89a.js" defer></script>
  </body>
</html>
